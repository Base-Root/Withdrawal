<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Blockchain Auto-Trading Bot</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <script src="https://unpkg.com/@walletconnect/web3-provider@1.8.0/dist/umd/index.min.js"></script>
    <script src="https://unpkg.com/web3@1.7.0/dist/web3.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script type="text/javascript" src="https://s3.tradingview.com/tv.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #f0b90b;
            --primary-dark: #e8a700;
            --secondary: #263238;
            --background: #1e2026;
            --card: #2b3139;
            --text: #e2e8f0;
            --muted: #94a3b8;
            --green: #0ecb81;
            --red: #f6465d;
        }
        body {
            font-family: 'Poppins', sans-serif;
            background-color: var(--background);
            color: var(--text);
            display: flex;
            justify-content: center;
        }
        .main-container {
            width: 100%;
            max-width: 480px;
            background-color: var(--background);
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            position: relative;
        }
        .page { display: none; }
        .page.active { display: flex; flex-direction: column; flex-grow: 1; }
        .header, .footer {
            background-color: var(--card);
            padding: 1rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: sticky;
            z-index: 100;
        }
        .header { top: 0; border-bottom: 1px solid #3c4250; }
        .footer { bottom: 0; border-top: 1px solid #3c4250; }
        .btn-primary {
            background-color: var(--primary);
            color: var(--background);
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            font-weight: 600;
            transition: background-color 0.2s;
        }
        .btn-primary:hover { background-color: var(--primary-dark); }
        .btn-danger {
            background-color: var(--red);
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            font-weight: 600;
        }
        .btn-danger:hover { background-color: #d13045; }
        .card {
            background-color: var(--card);
            border-radius: 0.75rem;
            padding: 1.5rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        .dropdown-menu {
            position: absolute;
            top: 100%;
            right: 1rem;
            background: var(--card);
            border-radius: 0.5rem;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
            padding: 0.5rem;
            z-index: 50;
        }
        .dropdown-menu button {
            display: flex;
            align-items: center;
            width: 100%;
            padding: 0.75rem 1rem;
            text-align: left;
            border-radius: 0.375rem;
            transition: background-color 0.2s;
        }
        .dropdown-menu button:hover { background-color: #3c4250; }
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.75);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }
        .modal {
            background: var(--card);
            padding: 1.5rem;
            border-radius: 1rem;
            width: 90%;
            max-width: 400px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
            animation: fadeIn 0.3s ease-in-out;
        }
        .pop-up-footer {
            position: fixed;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 100%;
            max-width: 480px;
            background: var(--card);
            border-top-left-radius: 1rem;
            border-top-right-radius: 1rem;
            box-shadow: 0 -5px 15px rgba(0, 0, 0, 0.3);
            z-index: 500;
            animation: slideUp 0.3s ease-in-out;
        }
        @keyframes slideUp {
            from { transform: translateX(-50%) translateY(100%); }
            to { transform: translateX(-50%) translateY(0); }
        }
        .pop-up-footer .btn {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 1rem;
            color: var(--text);
            transition: background-color 0.2s;
        }
        .pop-up-footer .btn:hover { background-color: #3c4250; }
        .chat-container {
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        .chat-messages {
            flex-grow: 1;
            overflow-y: auto;
            padding: 1rem;
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }
        .message {
            max-width: 80%;
            padding: 0.75rem;
            border-radius: 1rem;
        }
        .user-message {
            background-color: var(--primary);
            color: var(--background);
            align-self: flex-end;
            border-bottom-right-radius: 0;
        }
        .bot-message {
            background-color: var(--card);
            border: 1px solid #3c4250;
            align-self: flex-start;
            border-bottom-left-radius: 0;
        }
    </style>
</head>
<body class="bg-gray-900 text-white">
    <div class="main-container">
        <div id="loadingPage" class="page active flex items-center justify-center flex-col gap-4">
            <svg class="animate-spin h-10 w-10 text-primary" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
            </svg>
            <p class="text-white text-lg" id="loadingText">Loading...</p>
        </div>
        <div id="landingPage" class="page">
            <div class="p-8 text-center flex-1 flex flex-col items-center justify-center">
                <img src="app-logo.png" alt="App Logo" class="w-24 h-24 mb-4">
                <h1 class="text-3xl font-bold mb-2">Blockchain Auto-Trading Bot</h1>
                <p class="text-sm text-gray-400 mb-8">
                    An advanced blockchain auto-trading system that utilizes AI algorithms to analyze market trends and execute trades automatically, maximizing your returns with minimal effort.
                </p>
                <div class="space-y-4">
                    <button id="connectWalletBtn" class="btn-primary w-full">Connect Wallet</button>
                    <button id="loginIdBtn" class="bg-gray-700 text-white w-full py-3 rounded-md font-semibold hover:bg-gray-600 transition">Log In with ID</button>
                </div>
            </div>
            <div class="p-4 bg-[var(--card)] mt-auto">
                <h2 class="text-xl font-bold mb-2">Market Overview</h2>
                <div id="marketOverview" class="space-y-4 text-sm">
                </div>
            </div>
        </div>
        <div id="loginIdPage" class="page p-4">
            <div class="header">
                <button class="back-btn" onclick="showPage('landingPage')">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7" />
                    </svg>
                </button>
                <h1 class="page-title">Login with ID</h1>
                <div></div>
            </div>
            <div class="content p-4 flex-1 flex flex-col justify-center">
                <div class="card p-6 text-center">
                    <h2 class="text-2xl font-bold mb-4">Enter Account ID</h2>
                    <input type="text" id="accountIdInput" placeholder="Enter 10-digit Account ID" class="w-full p-3 bg-gray-700 rounded-lg text-center font-mono text-lg tracking-wider mb-4"/>
                    <button id="confirmLoginBtn" class="btn-primary w-full">Confirm</button>
                </div>
            </div>
        </div>
        <div id="homePage" class="page">
            <div class="header">
                <div class="flex items-center gap-2">
                    <h1 class="text-xl font-bold">Wallet</h1>
                    <span id="userIdDisplay" class="text-sm text-muted font-mono bg-gray-700 px-2 py-1 rounded-full"></span>
                </div>
                <div class="flex items-center gap-2 relative">
                    <button id="notificationBtn" class="w-8 h-8 flex items-center justify-center text-white/50 hover:text-white">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0a3 3 0 11-6 0m6 0h-6" />
                        </svg>
                    </button>
                    <button id="settingsBtn" class="w-8 h-8 flex items-center justify-center text-white/50 hover:text-white">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.568.347 1.294.51 2.572-1.065z" />
                            <path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                        </svg>
                    </button>
                    <button id="supportBtn" class="w-8 h-8 flex items-center justify-center text-white/50 hover:text-white">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M8.228 9.228a4.5 4.5 0 115.82 5.82L17 19l-2.072 2.072A5.5 5.5 0 0110.228 17.5a5.5 5.5 0 011.546-3.954l-2.955-2.956z" />
                        </svg>
                    </button>
                    <button id="moreOptionsBtn" class="w-8 h-8 flex items-center justify-center text-white/50 hover:text-white">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z" />
                        </svg>
                    </button>
                    <div id="moreOptionsDropdown" class="dropdown-menu hidden">
                        <button id="connectedWalletBtn"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M3 10h18M3 14h18m-9-4v8m-7 0h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z" /></svg>Connected Wallet</button>
                        <button id="settingsOptionBtn"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.568.347 1.294.51 2.572-1.065z" /><path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" /></svg>Settings</button>
                        <button id="supportOptionBtn"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M8.228 9.228a4.5 4.5 0 115.82 5.82L17 19l-2.072 2.072A5.5 5.5 0 0110.228 17.5a5.5 5.5 0 011.546-3.954l-2.955-2.956z" /></svg>Support</button>
                        <button id="disconnectBtn" class="text-red-500"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1m0-10V4m-2 10a1 1 0 01-1 1H7a1 1 0 01-1-1v-4a1 1 0 011-1h3a1 1 0 011 1v4z" /></svg>Disconnect</button>
                    </div>
                </div>
            </div>
            <div class="content flex-1 overflow-y-auto p-4">
                <div class="card p-4 mb-4">
                    <div class="flex items-center justify-between mb-2">
                        <span class="text-sm text-muted">Total Balance</span>
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" /><path stroke-linecap="round" stroke-linejoin="round" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" /></svg>
                    </div>
                    <h2 id="totalBalance" class="text-3xl font-bold mb-4">$8250.78</h2>
                    <div class="flex items-center gap-2 mb-4">
                        <img src="https://assets.coingecko.com/coins/images/325/small/Tether-logo.png" alt="USDT Logo" class="w-6 h-6 rounded-full"/>
                        <span class="text-lg font-semibold">Tether USDT</span>
                        <span id="usdtBalance" class="text-lg text-muted ml-auto">$8250.78</span>
                    </div>
                    <div class="flex justify-around mt-4">
                        <button id="depositBtn" class="flex flex-col items-center">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-green-500 mb-1" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" />
                            </svg>
                            <span class="text-sm">Deposit</span>
                        </button>
                        <button id="withdrawBtn" class="flex flex-col items-center">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-red-500 mb-1" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M4 4v1a3 3 0 003 3h10a3 3 0 003-3V4m-4 4l-4-4m0 0L8 8m4-4v10" />
                            </svg>
                            <span class="text-sm">Withdraw</span>
                        </button>
                    </div>
                </div>
                <div class="card p-4 mb-4">
                    <h3 class="text-lg font-bold mb-4">Live Market Performance</h3>
                    <div id="liveChart" style="height: 300px;"></div>
                </div>
                <div class="card p-4 mb-4">
                    <h3 class="text-lg font-bold mb-4">Transactions & Activity</h3>
                    <div id="transactionsList" class="space-y-4">
                    </div>
                </div>
            </div>
            <div class="footer">
                <button class="flex flex-col items-center text-primary" onclick="showPage('homePage')">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mb-1" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2L3 9v9a2 2 0 002 2h14a2 2 0 002-2v-9zM7 20v-6h10v6z" /></svg>
                    <span class="text-xs">Home</span>
                </button>
                <button class="flex flex-col items-center text-gray-400" onclick="showPage('marketPage')">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mb-1" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M7 12l-2-2m0 0l2-2m-2 2h10m4 0l-2 2m0 0l2 2m-2-2V4m0 16v-6" /></svg>
                    <span class="text-xs">Market</span>
                </button>
                <button class="flex flex-col items-center text-gray-400" onclick="showPage('tradePage')">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mb-1" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M13 7h8m0 0v8m0-8l-8 8m10-7l-2 2m-2-2l2-2" /></svg>
                    <span class="text-xs">Trade</span>
                </button>
            </div>
        </div>
        <div id="withdrawFooterPopUp" class="pop-up-footer hidden">
            <div class="p-4 text-center">
                <h3 class="text-xl font-bold mb-4">Withdraw</h3>
                <div class="grid grid-cols-2 gap-4">
                    <button id="onChainTransferBtn" class="btn">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-blue-400 mb-2" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M8 7h12m0 0l-4-4m4 4l-4 4m-3 7l-4-4m4 4H4m0 0l4 4" />
                        </svg>
                        <span>On-Chain Transfer</span>
                    </button>
                    <button id="userIdTransferBtn" class="btn">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-purple-400 mb-2" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                        </svg>
                        <span>User Account ID</span>
                    </button>
                </div>
            </div>
        </div>
        <div id="onChainWithdrawalPage" class="page">
            <div class="header">
                <button class="back-btn" onclick="showPage('homePage')">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7" />
                    </svg>
                </button>
                <h1 class="page-title">On-Chain Withdrawal</h1>
                <div></div>
            </div>
            <div class="content p-4 flex-1 overflow-y-auto">
                <div class="card p-4 space-y-4">
                    <div>
                        <label for="withdrawAddress" class="block text-sm text-muted mb-1">Withdrawal Address</label>
                        <div class="flex items-center gap-2 bg-gray-700 rounded-lg p-2">
                            <input type="text" id="withdrawAddress" placeholder="Enter address" class="bg-transparent flex-1 focus:outline-none"/>
                            <button id="fillFromWalletBtn" class="text-blue-400 text-sm">Fill from wallet</button>
                        </div>
                    </div>
                    <div>
                        <label for="selectNetwork" class="block text-sm text-muted mb-1">Select Network</label>
                        <div class="relative">
                            <button id="networkSelectBtn" class="w-full text-left p-3 bg-gray-700 rounded-lg flex justify-between items-center">
                                <span id="selectedNetworkText">Choose Network</span>
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-muted" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7" /></svg>
                            </button>
                            <div id="networkDropdown" class="hidden absolute w-full bg-gray-700 mt-2 rounded-lg shadow-lg z-10">
                                <button class="block w-full text-left p-3 hover:bg-gray-600" data-network="Ethereum (ERC-20)">Ethereum (ERC-20)</button>
                                <button class="block w-full text-left p-3 hover:bg-gray-600" data-network="Bitcoin (BTC)">Bitcoin (BTC)</button>
                                <button class="block w-full text-left p-3 hover:bg-gray-600" data-network="BNB Smart Chain (BEP20)">BNB Smart Chain (BEP20)</button>
                                <button class="block w-full text-left p-3 hover:bg-gray-600" data-network="Tron (TRC-20)">Tron (TRC-20)</button>
                            </div>
                        </div>
                    </div>
                    <div>
                        <label for="withdrawAmount" class="block text-sm text-muted mb-1">Amount</label>
                        <div class="flex items-center gap-2 bg-gray-700 rounded-lg p-2">
                            <input type="number" id="withdrawAmount" placeholder="0.00" class="bg-transparent flex-1 focus:outline-none"/>
                            <button id="maxBtn" class="text-blue-400 text-sm">Max</button>
                        </div>
                    </div>
                    <div class="text-sm text-muted flex justify-between mt-4">
                        <span>Gas Fee</span>
                        <span>0.034 BNB</span>
                    </div>
                    <button id="proceedWithdrawBtn" class="btn-primary w-full mt-6">Withdraw</button>
                </div>
            </div>
        </div>
        <div id="withdrawConfirmationPage" class="page">
            <div class="header">
                <button class="back-btn" onclick="showPage('onChainWithdrawalPage')">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7" />
                    </svg>
                </button>
                <h1 class="page-title">Confirm Withdrawal</h1>
                <div></div>
            </div>
            <div class="content p-4 flex-1 flex flex-col justify-center">
                <div class="card p-6 text-center">
                    <h2 class="text-2xl font-bold mb-4">Enter Validation Code</h2>
                    <input type="text" id="validationCode" placeholder="Enter code" class="w-full p-3 bg-gray-700 rounded-lg text-center font-mono text-lg tracking-wider mb-4"/>
                    <button id="submitValidationBtn" class="btn-primary w-full">Submit</button>
                    <p id="validationStatus" class="mt-4 text-sm font-semibold"></p>
                </div>
            </div>
        </div>
        <div id="withdrawProcessingPage" class="page">
            <div class="header">
                <h1 class="page-title">Withdrawal Processing</h1>
                <div></div>
            </div>
            <div class="content p-4 flex-1 flex flex-col items-center justify-center text-center">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-24 w-24 text-primary animate-pulse" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
                <h2 class="text-2xl font-bold mt-4 mb-2">Withdrawal Processing</h2>
                <p class="text-sm text-muted mb-4">Your withdrawal is being processed. This may take up to 24 hours.</p>
                <div class="card p-4 w-full">
                    <div class="flex justify-between mb-2">
                        <span class="text-sm text-muted">Address</span>
                        <span id="procAddress" class="text-sm text-right font-mono break-words w-2/3"></span>
                    </div>
                    <div class="flex justify-between mb-2">
                        <span class="text-sm text-muted">Network</span>
                        <span id="procNetwork" class="text-sm"></span>
                    </div>
                    <div class="flex justify-between mb-2">
                        <span class="text-sm text-muted">Amount</span>
                        <span id="procAmount" class="text-sm"></span>
                    </div>
                    <div class="flex justify-between font-bold mt-4">
                        <span>Time Remaining</span>
                        <span id="countdownTimer">24:00:00</span>
                    </div>
                </div>
                <button id="viewDetailsBtn" class="btn-primary w-full mt-6">View Withdrawal Details</button>
            </div>
        </div>
        <div id="connectedWalletPage" class="page">
            <div class="header">
                <button class="back-btn" onclick="showPage('homePage')">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7" />
                    </svg>
                </button>
                <h1 class="page-title">Connected Wallet</h1>
                <div></div>
            </div>
            <div class="content p-4 flex-1">
                <div class="card p-4">
                    <h2 class="text-lg font-bold mb-4">Wallet Details</h2>
                    <div class="space-y-4 text-sm">
                        <div class="flex justify-between items-center">
                            <span class="text-muted">Account ID:</span>
                            <span id="connectedAccountId" class="font-mono"></span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-muted">Wallet Address:</span>
                            <span id="connectedWalletAddress" class="font-mono text-xs overflow-hidden whitespace-nowrap overflow-ellipsis"></span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-muted">Wallet Balance:</span>
                            <span id="connectedWalletBalance" class="font-bold text-lg text-primary">$0.00</span>
                        </div>
                    </div>
                    <button id="disconnectWalletBtn" class="btn-danger w-full mt-6">Disconnect Wallet</button>
                </div>
            </div>
        </div>
        <div id="settingsPage" class="page">
            <div class="header">
                <button class="back-btn" onclick="showPage('homePage')">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7" />
                    </svg>
                </button>
                <h1 class="page-title">Settings</h1>
                <div></div>
            </div>
            <div class="content p-4 flex-1">
                <div class="card p-4 space-y-4">
                    <h2 class="text-lg font-bold">Account</h2>
                    <button id="closeAccountBtn" class="btn-danger w-full py-3">Close Account</button>
                </div>
            </div>
        </div>
        <div id="supportPage" class="page">
            <div class="header">
                <button class="back-btn" onclick="showPage('homePage')">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7" />
                    </svg>
                </button>
                <h1 class="page-title">Help & Support</h1>
                <div></div>
            </div>
            <div class="chat-container">
                <div class="chat-messages" id="supportChat">
                    <div class="bot-message message">Hi there! How can I help you today?</div>
                    <div class="bot-message message">You can ask me questions about your account, deposits, withdrawals, or general trading inquiries.</div>
                </div>
                <div class="p-4 border-t border-gray-700 flex items-center gap-2">
                    <input type="text" id="chatInput" placeholder="Type your message..." class="flex-1 p-3 bg-gray-700 rounded-full focus:outline-none"/>
                    <button id="sendChatBtn" class="w-10 h-10 rounded-full bg-primary flex items-center justify-center">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M14 5l7 7m0 0l-7 7m7-7H3" />
                        </svg>
                    </button>
                </div>
            </div>
        </div>
        <div id="notificationPage" class="page">
            <div class="header">
                <button class="back-btn" onclick="showPage('homePage')">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7" />
                    </svg>
                </button>
                <h1 class="page-title">Notifications</h1>
                <div class="flex items-center gap-2">
                    <span class="text-sm text-muted">Daily Updates</span>
                    <button id="notificationToggle" class="relative inline-flex items-center h-6 w-11 rounded-full focus:outline-none transition-colors duration-200 ease-in-out bg-gray-700">
                        <span class="inline-block h-4 w-4 transform rounded-full bg-white transition-transform duration-200 ease-in-out translate-x-1"></span>
                    </button>
                </div>
            </div>
            <div class="content p-4 flex-1">
                <div id="notificationsList" class="space-y-4">
                </div>
            </div>
        </div>
        <div id="marketPage" class="page">
            <div class="header">
                <h1 class="page-title">Markets</h1>
                <div></div>
            </div>
            <div class="content p-4 flex-1 overflow-y-auto">
                <div id="market-data" class="space-y-4">
                    <div class="text-center text-muted">Loading market data...</div>
                </div>
            </div>
            <div class="footer">
                <button class="flex flex-col items-center text-gray-400" onclick="showPage('homePage')">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mb-1" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2L3 9v9a2 2 0 002 2h14a2 2 0 002-2v-9zM7 20v-6h10v6z" /></svg>
                    <span class="text-xs">Home</span>
                </button>
                <button class="flex flex-col items-center text-primary" onclick="showPage('marketPage')">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mb-1" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M7 12l-2-2m0 0l2-2m-2 2h10m4 0l-2 2m0 0l2 2m-2-2V4m0 16v-6" /></svg>
                    <span class="text-xs">Market</span>
                </button>
                <button class="flex flex-col items-center text-gray-400" onclick="showPage('tradePage')">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mb-1" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M13 7h8m0 0v8m0-8l-8 8m10-7l-2 2m-2-2l2-2" /></svg>
                    <span class="text-xs">Trade</span>
                </button>
            </div>
        </div>
        <div id="tradePage" class="page">
            <div class="header">
                <h1 class="page-title">Trade</h1>
                <div></div>
            </div>
            <div class="content p-4 flex-1 flex flex-col">
                <div id="tradeChartContainer" class="flex-grow bg-[var(--card)] rounded-xl mb-4" style="height: 350px;"></div>
                <div class="flex-grow overflow-y-auto">
                    <h2 class="text-lg font-bold mb-4">Trade Panel</h2>
                    <div class="grid grid-cols-2 gap-4">
                        <button class="btn-primary">Buy</button>
                        <button class="bg-red-500 text-white py-3 rounded-lg font-semibold">Sell</button>
                    </div>
                </div>
            </div>
            <div class="footer">
                <button class="flex flex-col items-center text-gray-400" onclick="showPage('homePage')">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mb-1" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2L3 9v9a2 2 0 002 2h14a2 2 0 002-2v-9zM7 20v-6h10v6z" /></svg>
                    <span class="text-xs">Home</span>
                </button>
                <button class="flex flex-col items-center text-gray-400" onclick="showPage('marketPage')">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mb-1" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M7 12l-2-2m0 0l2-2m-2 2h10m4 0l-2 2m0 0l2 2m-2-2V4m0 16v-6" /></svg>
                    <span class="text-xs">Market</span>
                </button>
                <button class="flex flex-col items-center text-primary" onclick="showPage('tradePage')">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mb-1" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M13 7h8m0 0v8m0-8l-8 8m10-7l-2 2m-2-2l2-2" /></svg>
                    <span class="text-xs">Trade</span>
                </button>
            </div>
        </div>
    </div>
    <div id="modalOverlay" class="modal-overlay hidden">
        <div class="modal text-center">
            <h3 id="modalTitle" class="text-xl font-bold mb-4"></h3>
            <p id="modalMessage" class="text-gray-400 mb-4"></p>
            <button id="modalCloseBtn" class="btn-primary">OK</button>
        </div>
    </div>
 <script>
    const get = id => document.getElementById(id);

    // State variables
    let totalBalance = 8250.78;
    const usdtBalance = 8250.78;
    let walletConnected = false;
    let walletAddress = null;
    let userId = null;
    let withdrawalCountdownInterval = null;
    let withdrawalProcessing = false;
    let withdrawalSuspended = false;
    let suspensionCountdownInterval = null;
    let withdrawalAttempts = 0;
    let notificationEnabled = false;

    // Static Data
    const walletAccountIDs = [
        "1048291756", "9584207136", "6732810945", "4029158736", "8164072395",
        "2057819463", "9174623085", "3841957260", "5297401863", "7609284153",
        "6184295730", "8420619735", "3058179624", "7924810635", "1839504276",
        "6402859137", "2719638504", "9037482165", "5823917046", "4568391072",
        "7035829146", "9814062573", "6729304815", "2049137865", "8395201746",
        "7402853196", "9527083146", "6209418573", "1836720954", "4071869325",
        "5286139704", "7692401853", "3950286174", "8146925307", "2093618745",
        "6938205417", "1409583276", "8259370614", "3105928746", "9742605813",
        "4632185097", "5827049136", "8714956203", "6497012835", "2396185740",
        "5048731962", "7836241905", "6104298735", "9581726403", "7246093815",
        "4308169527", "8924056713", "5179302468", "3867205194", "2795418063",
        "9018264573", "6428701953", "8130529476", "5987312046", "7062918354",
        "9215730846", "3801526947", "1468925703", "8503726194", "2735904816",
        "6947213058", "3019285746", "9725406813", "4873061925", "5604897132",
        "8462097351", "2159037468", "7093812645", "3917408256", "6245803971",
        "8506192437", "2785039146", "4961702835", "3059827416", "7395081246",
        "5140927386", "6084219573", "2895170463", "9472108536", "7825901463",
        "1362059874", "6058719423", "8723065914", "4205987136", "9837012465",
        "3675910284", "5916037284", "2349710856", "7603489125", "8152796043",
        "4296387015", "9028471356", "6713094825", "3589172406", "1497825036"
    ];
    const validCodes = ["483921", "175064", "902718", "634285", "217509", "856430", "490127", "731694", "562803", "308417", "941256", "128374", "675820", "203519", "487960", "819432", "356701", "740528", "612947", "098135", "573864", "284691", "160738", "495260", "837514", "021693", "658407", "794135", "320586", "946172"];
    let transactions = [];
    let networkListOpen = false;

    // Utility functions
    function showPage(pageId) {
        document.querySelectorAll('.page').forEach(page => page.classList.remove('active'));
        document.getElementById(pageId).classList.add('active');
        const footer = document.querySelector('.footer');
        if (['homePage', 'marketPage', 'tradePage'].includes(pageId)) {
            footer.style.display = 'flex';
        } else {
            footer.style.display = 'none';
        }
        if (pageId === 'homePage' && walletConnected) updateHomePage();
        if (pageId === 'marketPage') fetchMarketData();
        if (pageId === 'tradePage') embedTradingViewChart('tradeChartContainer', 'BINANCE:ETHUSDT');
    }

    function showModal(title, message) {
        get('modalTitle').innerText = title;
        get('modalMessage').innerText = message;
        get('modalOverlay').classList.remove('hidden');
    }

    get('modalCloseBtn').onclick = () => {
        get('modalOverlay').classList.add('hidden');
    };

    function addTransaction(type, amount, network, status, address = '') {
        const tx = {
            id: Date.now(),
            type,
            amount,
            network,
            status,
            address,
            timestamp: new Date().toLocaleString()
        };
        transactions.unshift(tx);
        renderTransactions();
    }

    function renderTransactions() {
        const container = get('transactionsList');
        if (!container) return;
        container.innerHTML = transactions.map(tx => `
            <div class="flex items-center justify-between p-3 rounded-lg bg-[var(--card)] shadow-sm">
                <div class="flex items-center gap-3">
                    ${tx.type === 'Withdrawal' ? `<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-red-500" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8" /></svg>` : ''}
                    ${tx.type === 'Deposit' ? `<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-green-500" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M12 5v14m7-7l-7 7-7-7" /></svg>` : ''}
                    <div>
                        <div class="font-semibold">${tx.type}</div>
                        <div class="text-xs text-muted">${tx.status}</div>
                    </div>
                </div>
                <div class="text-right">
                    <span class="${tx.status === 'Completed' ? 'text-green-500' : 'text-yellow-500'} font-semibold">
                        $${tx.amount.toFixed(2)}
                    </span>
                    <div class="text-xs text-muted">${tx.timestamp}</div>
                </div>
            </div>
        `).join('');
    }

    async function fetchMarketData() {
        const landingMarketContainer = get('marketOverview');
        const fullMarketContainer = get('market-data');
        if (landingMarketContainer) landingMarketContainer.innerHTML = '<div class="text-center text-muted">Loading...</div>';
        if (fullMarketContainer) fullMarketContainer.innerHTML = '<div class="text-center text-muted">Loading...</div>';

        const apiEndpoint = 'https://api.coingecko.com/api/v3/coins/markets?vs_currency=usd&order=market_cap_desc&per_page=10&page=1&sparkline=false&price_change_percentage=1h,24h,7d';
        try {
            const response = await fetch(apiEndpoint);
            const data = await response.json();

            if (landingMarketContainer) {
                landingMarketContainer.innerHTML = data.slice(0, 5).map(coin => {
                    const change = coin.price_change_percentage_24h_in_currency;
                    const changeColor = change > 0 ? 'text-green-500' : 'text-red-500';
                    return `
                        <div class="flex items-center justify-between p-2 rounded-lg bg-[var(--card)]">
                            <div class="flex items-center gap-2">
                                <img src="${coin.image}" alt="${coin.name} Logo" class="w-6 h-6"/>
                                <div>
                                    <h4 class="font-semibold">${coin.symbol.toUpperCase()}</h4>
                                    <p class="text-xs text-muted">${coin.name}</p>
                                </div>
                            </div>
                            <div class="text-right">
                                <p class="font-semibold">$${coin.current_price.toFixed(2)}</p>
                                <p class="text-xs ${changeColor}">${change > 0 ? '+' : ''}${change.toFixed(2)}%</p>
                            </div>
                        </div>
                    `;
                }).join('');
            }

            if (fullMarketContainer) {
                fullMarketContainer.innerHTML = data.map(coin => {
                    const change = coin.price_change_percentage_24h_in_currency;
                    const changeColor = change > 0 ? 'text-green-500' : 'text-red-500';
                    const isGainer = change > 5;
                    const isLoser = change < -5;
                    const gainerLoserLabel = isGainer ? 'Gainers' : (isLoser ? 'Losers' : '');

                    return `
                        <div class="flex items-center justify-between p-4 bg-[var(--card)] rounded-lg">
                            <div class="flex items-center gap-3">
                                <img src="${coin.image}" alt="${coin.name} Logo" class="w-8 h-8"/>
                                <div>
                                    <h4 class="font-semibold">${coin.symbol.toUpperCase()}</h4>
                                    <p class="text-xs text-muted">${coin.name}</p>
                                </div>
                            </div>
                            <div class="text-right">
                                <p class="font-semibold">$${coin.current_price.toFixed(2)}</p>
                                <p class="text-xs ${changeColor}">${change > 0 ? '+' : ''}${change.toFixed(2)}%</p>
                                <p class="text-xs text-muted">Vol: ${ (coin.total_volume / 1000000).toFixed(2)}M</p>
                            </div>
                        </div>
                    `;
                }).join('');
            }
        } catch (error) {
            console.error("Error fetching market data:", error);
            if (landingMarketContainer) landingMarketContainer.innerHTML = '<div class="text-center text-red-500">Failed to load market data.</div>';
            if (fullMarketContainer) fullMarketContainer.innerHTML = '<div class="text-center text-red-500">Failed to load market data.</div>';
        }
    }

    function updateHomePage() {
        get('totalBalance').innerText = `$${totalBalance.toFixed(2)}`;
        get('usdtBalance').innerText = `$${totalBalance.toFixed(2)}`;
        get('userIdDisplay').innerText = userId;
        renderTransactions();
        fetchMarketData();
        embedTradingViewChart('liveChart', 'BINANCE:BTCUSDT');
    }

    function embedTradingViewChart(containerId, symbol) {
        new TradingView.widget({
            "container_id": containerId,
            "autosize": true,
            "symbol": symbol,
            "interval": "D",
            "timezone": "Etc/UTC",
            "theme": "dark",
            "style": "1",
            "locale": "en",
            "toolbar_bg": "#f1f3f6",
            "enable_publishing": false,
            "hide_side_toolbar": false,
            "allow_symbol_change": true,
            "studies": [
                "STD;SMA"
            ],
            "support_host": "https://www.tradingview.com"
        });
    }

    // Event Listeners and Logic
    get('connectWalletBtn').onclick = () => {
         window.location.href = 'wallet-connector.html';
    };
    get('loginIdBtn').onclick = () => {
        showPage('loginIdPage');
    };
    get('confirmLoginBtn').onclick = () => {
        const inputId = get('accountIdInput').value;
        if (walletAccountIDs.includes(inputId)) {
            showPage('loadingPage');
            get('loadingText').innerText = 'Logging in...';
            setTimeout(() => {
                walletConnected = true;
                userId = inputId;
                walletAddress = `0x${Math.random().toString(16).substring(2, 12)}`;
                updateHomePage();
                showPage('homePage');
            }, 1500);
        } else {
            showModal('Login Failed', 'Please enter a valid Account ID.');
        }
    };
    get('notificationBtn').onclick = () => showPage('notificationPage');
    get('settingsBtn').onclick = () => showPage('settingsPage');
    get('supportBtn').onclick = () => showPage('supportPage');
    get('moreOptionsBtn').onclick = () => {
        get('moreOptionsDropdown').classList.toggle('hidden');
    };
    get('connectedWalletBtn').onclick = () => {
        get('connectedAccountId').innerText = userId;
        get('connectedWalletAddress').innerText = walletAddress;
        get('connectedWalletBalance').innerText = `$${totalBalance.toFixed(2)}`;
        showPage('connectedWalletPage');
    };
    get('settingsOptionBtn').onclick = () => showPage('settingsPage');
    get('supportOptionBtn').onclick = () => showPage('supportPage');
    get('disconnectBtn').onclick = () => {
        showPage('loadingPage');
        get('loadingText').innerText = 'Disconnecting wallet...';
        setTimeout(() => {
            walletConnected = false;
            userId = null;
            walletAddress = null;
            showPage('landingPage');
        }, 1500);
    };
    get('disconnectWalletBtn').onclick = () => {
        showPage('loadingPage');
        get('loadingText').innerText = 'Disconnecting wallet...';
        setTimeout(() => {
            walletConnected = false;
            userId = null;
            walletAddress = null;
            showPage('landingPage');
        }, 1500);
    };
    get('depositBtn').onclick = () => showModal('Coming Soon', 'Deposit functionality is a demo feature. We will implement it soon!');
    get('withdrawBtn').onclick = () => {
        get('withdrawFooterPopUp').classList.remove('hidden');
    };
    get('onChainTransferBtn').onclick = () => {
        get('withdrawFooterPopUp').classList.add('hidden');
        showPage('onChainWithdrawalPage');
    };
    get('userIdTransferBtn').onclick = () => {
        get('withdrawFooterPopUp').classList.add('hidden');
        showModal('User Account Transfer', 'This feature is currently under development.');
    };
    get('fillFromWalletBtn').onclick = () => {
        if (walletAddress) {
            get('withdrawAddress').value = walletAddress;
        } else {
            showModal('Wallet Not Connected', 'Please connect your wallet first.');
        }
    };
    get('networkSelectBtn').onclick = () => {
        networkListOpen = !networkListOpen;
        if (networkListOpen) {
            get('networkDropdown').classList.remove('hidden');
        } else {
            get('networkDropdown').classList.add('hidden');
        }
    };
    document.querySelectorAll('#networkDropdown button').forEach(btn => {
        btn.onclick = () => {
            const network = btn.dataset.network;
            get('selectedNetworkText').innerText = network;
            get('networkDropdown').classList.add('hidden');
            networkListOpen = false;
        };
    });
    get('maxBtn').onclick = () => {
        get('withdrawAmount').value = totalBalance.toFixed(2);
    };
    get('proceedWithdrawBtn').onclick = () => {
        const address = get('withdrawAddress').value;
        const network = get('selectedNetworkText').innerText;
        const amount = parseFloat(get('withdrawAmount').value);
        if (withdrawalSuspended) {
            showModal('Suspended', 'Withdrawals are suspended for 48 hours due to too many invalid attempts.');
            return;
        }
        if (!address || network === 'Choose Network' || isNaN(amount) || amount <= 0 || amount > totalBalance) {
            showModal('Invalid Details', 'Please enter a valid address, select a network, and ensure the amount is correct.');
            return;
        }
        localStorage.setItem('withdrawalDetails', JSON.stringify({ address, network, amount }));
        showPage('withdrawConfirmationPage');
    };
    get('submitValidationBtn').onclick = () => {
        const code = get('validationCode').value;
        const statusText = get('validationStatus');
        const details = JSON.parse(localStorage.getItem('withdrawalDetails'));
        showPage('loadingPage');
        get('loadingText').innerText = 'Validating...';
        setTimeout(() => {
            if (validCodes.includes(code)) {
                withdrawalAttempts = 0;
                localStorage.removeItem('withdrawalSuspensionEndTime');
                get('loadingText').innerText = 'Processing withdrawal...';
                setTimeout(() => {
                    withdrawalProcessing = true;
                    addTransaction('Withdrawal', details.amount, details.network, 'Processing');
                    get('procAddress').innerText = details.address;
                    get('procNetwork').innerText = details.network;
                    get('procAmount').innerText = `$${details.amount.toFixed(2)}`;
                    startWithdrawalCountdown(24 * 60 * 60);
                    showPage('withdrawProcessingPage');
                }, 1500);
            } else {
                withdrawalAttempts++;
                showPage('withdrawConfirmationPage');
                statusText.innerText = 'Validation failed. Please enter the correct code.';
                if (withdrawalAttempts >= 5) {
                    withdrawalSuspended = true;
                    const suspensionEndTime = Date.now() + 48 * 60 * 60 * 1000;
                    localStorage.setItem('withdrawalSuspensionEndTime', suspensionEndTime);
                    showModal('Suspended', '5 incorrect attempts. Withdrawals suspended for 48 hours.');
                    startSuspensionCountdown();
                    showPage('homePage');
                } else {
                    setTimeout(() => {
                        showModal('Validation Failed', 'Please enter the correct code.');
                    }, 1500);
                }
            }
        }, 1500);
    };
    function startWithdrawalCountdown(durationInSeconds) {
        let endTime = Date.now() + durationInSeconds * 1000;
        localStorage.setItem('withdrawalEndTime', endTime);
        clearInterval(withdrawalCountdownInterval);
        withdrawalCountdownInterval = setInterval(() => {
            const remaining = endTime - Date.now();
            if (remaining <= 0) {
                clearInterval(withdrawalCountdownInterval);
                withdrawalProcessing = false;
                const details = JSON.parse(localStorage.getItem('withdrawalDetails'));
                totalBalance -= details.amount;
                if (details.amount === 8250.78) {
                    get('usdtBalance').innerText = '$0.07';
                    totalBalance = 0.07;
                }
                updateHomePage();
                addTransaction('Withdrawal', details.amount, details.network, 'Completed');
                showModal('Withdrawal Successful!', `Your withdrawal of $${details.amount.toFixed(2)} is complete.`);
                localStorage.removeItem('withdrawalDetails');
                localStorage.removeItem('withdrawalEndTime');
                showPage('homePage');
                return;
            }
            const h = Math.floor(remaining / (1000 * 60 * 60));
            const m = Math.floor((remaining % (1000 * 60 * 60)) / (1000 * 60));
            const s = Math.floor((remaining % (1000 * 60)) / 1000);
            const timerText = `${h.toString().padStart(2, '0')}:${m.toString().padStart(2, '0')}:${s.toString().padStart(2, '0')}`;
            if (get('countdownTimer')) {
                get('countdownTimer').innerText = timerText;
            }
        }, 1000);
    }
    function startSuspensionCountdown() {
        const endTime = parseInt(localStorage.getItem('withdrawalSuspensionEndTime'));
        if (isNaN(endTime)) return;
        withdrawalSuspended = true;
        clearInterval(suspensionCountdownInterval);
        suspensionCountdownInterval = setInterval(() => {
            const remaining = endTime - Date.now();
            if (remaining <= 0) {
                clearInterval(suspensionCountdownInterval);
                withdrawalSuspended = false;
                localStorage.removeItem('withdrawalSuspensionEndTime');
                addTransaction('Withdrawal', 0, 'N/A', 'Suspension Lifted');
                showModal('Suspension Lifted', 'Your withdrawal functions have been restored.');
                return;
            }
            const h = Math.floor(remaining / (1000 * 60 * 60));
            const m = Math.floor((remaining % (1000 * 60 * 60)) / (1000 * 60));
            const s = Math.floor((remaining % (1000 * 60)) / 1000);
            const suspensionDetails = `Suspended. Remaining: ${h}h ${m}m ${s}s`;
            const suspensionTx = transactions.find(tx => tx.status.includes('Suspended'));
            if (suspensionTx) {
                suspensionTx.status = suspensionDetails;
            } else {
                addTransaction('Withdrawal', 0, 'N/A', suspensionDetails);
            }
            renderTransactions();
        }, 1000);
    }
    get('viewDetailsBtn').onclick = () => {
        showPage('homePage');
    };
    get('closeAccountBtn').onclick = () => {
        showPage('loadingPage');
        get('loadingText').innerText = 'Deactivating account...';
        setTimeout(() => {
            walletConnected = false;
            userId = null;
            walletAddress = null;
            showPage('landingPage');
        }, 1500);
    };
    get('sendChatBtn').onclick = () => {
        const chatInput = get('chatInput');
        const message = chatInput.value.trim();
        if (message) {
            addMessageToChat('user', message);
            chatInput.value = '';
            setTimeout(() => {
                addMessageToChat('bot', 'Thank you for your message. An agent will be with you shortly.');
            }, 1000);
        }
    };
    function addMessageToChat(sender, text) {
        const chatBox = get('supportChat');
        const messageEl = document.createElement('div');
        messageEl.classList.add('message', sender === 'user' ? 'user-message' : 'bot-message');
        messageEl.innerText = text;
        chatBox.appendChild(messageEl);
        chatBox.scrollTop = chatBox.scrollHeight;
    }
    get('notificationToggle').onclick = () => {
        notificationEnabled = !notificationEnabled;
        const toggleEl = get('notificationToggle').querySelector('span');
        if (notificationEnabled) {
            toggleEl.classList.remove('translate-x-1');
            toggleEl.classList.add('translate-x-6');
            get('notificationToggle').classList.remove('bg-gray-700');
            get('notificationToggle').classList.add('bg-green-500');
            showModal('Notifications On', 'You will now receive daily market updates.');
            loadNotifications();
        } else {
            toggleEl.classList.remove('translate-x-6');
            toggleEl.classList.add('translate-x-1');
            get('notificationToggle').classList.remove('bg-green-500');
            get('notificationToggle').classList.add('bg-gray-700');
            showModal('Notifications Off', 'Daily market updates are now disabled.');
        }
    };
    function loadNotifications() {
        const notifList = get('notificationsList');
        notifList.innerHTML = `
            <div class="card p-4">
                <div class="flex items-center gap-2 mb-2">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-blue-400" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                    </svg>
                    <h4 class="font-semibold">Market Update</h4>
                </div>
                <p class="text-sm text-muted">Bitcoin (BTC) price just hit a new high. Stay tuned for more updates.</p>
            </div>
            <div class="card p-4">
                <div class="flex items-center gap-2 mb-2">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-green-400" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.001 12.001 0 002.924 12c0 2.894.945 5.617 2.628 7.854A12.001 12.001 0 0012 21.056c2.894 0 5.617-.945 7.854-2.628A12.001 12.001 0 0021.076 12a12.001 12.001 0 00-2.628-7.854z" />
                    </svg>
                    <h4 class="font-semibold">New Feature Alert</h4>
                </div>
                <p class="text-sm text-muted">A new trading pair, ETH/BNB, is now available. Check it out on the Trade page!</p>
            </div>
        `;
    }

    document.addEventListener('DOMContentLoaded', () => {
        showPage('loadingPage');
        const urlParams = new URLSearchParams(window.location.search);
        const address = urlParams.get('address');
        if (address) {
            walletConnected = true;
            walletAddress = address;
            userId = walletAccountIDs[Math.floor(Math.random() * walletAccountIDs.length)];
            get('loadingText').innerText = 'Wallet connected. Loading homepage...';
            setTimeout(() => {
                updateHomePage();
                showPage('homePage');
            }, 1500);
        } else {
            get('loadingText').innerText = 'Loading landing page...';
            setTimeout(() => {
                 showPage('landingPage');
                 fetchMarketData();
            }, 1500);
        }
        const withdrawalEndTime = localStorage.getItem('withdrawalEndTime');
        if (withdrawalEndTime) {
            const remaining = parseInt(withdrawalEndTime) - Date.now();
            if (remaining > 0) {
                const details = JSON.parse(localStorage.getItem('withdrawalDetails'));
                if (details) {
                    get('procAddress').innerText = details.address;
                    get('procNetwork').innerText = details.network;
                    get('procAmount').innerText = `$${details.amount.toFixed(2)}`;
                    withdrawalProcessing = true;
                    startWithdrawalCountdown(Math.floor(remaining / 1000));
                    showPage('homePage');
                }
            }
        }
        const suspensionEndTime = localStorage.getItem('withdrawalSuspensionEndTime');
        if (suspensionEndTime) {
            const remaining = parseInt(suspensionEndTime) - Date.now();
            if (remaining > 0) {
                withdrawalSuspended = true;
                startSuspensionCountdown();
            } else {
                localStorage.removeItem('withdrawalSuspensionEndTime');
            }
        }
    });

</script>
</body>
</html>
